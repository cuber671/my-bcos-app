{"author":"FISCO BCOS Supply Chain Finance Team","details":"仓单融资管理智能合约 V2.0 核心功能： 1. 仓单生命周期管理（创建、验证、质押、融资、释放、清算） 2. 仓单转让管理（转让、转移） 3. 融资管理（申请融资、批准融资、偿还融资） 4. 冻结管理（冻结仓单、解冻仓单） 设计原则： ✅ 数据精简化与哈希化（仅核心字段上链，扩展数据哈希化） ✅ 严格访问控制（onlyAdmin, onlyJavaBackend, onlyOwner, onlyWarehouse） ✅ 规避栈溢出（使用struct封装） ✅ 异常处理与状态一致性（require校验，Checks-Effects-Interactions模式） ✅ 充分利用事件（10个事件支持Java后端监听）","kind":"dev","methods":{"applyFinance(string,address,uint256,uint256,uint256)":{"details":"申请融资","params":{"amount":"融资金额","duration":"融资期限（天）","institution":"融资机构","rate":"融资利率（基点）","receiptId":"仓单ID"},"returns":{"_0":"bool 是否成功"}},"approveFinance(string)":{"details":"批准融资","params":{"receiptId":"仓单ID"},"returns":{"_0":"bool 是否成功"}},"constructor":{"details":"构造函数，初始化合约"},"createReceipt(string,address,uint256,uint256,uint256,bytes32,bytes32)":{"details":"创建仓单","params":{"coreDataHash":"核心数据哈希","expiryDate":"过期日期（时间戳）","extendedDataHash":"扩展数据哈希","receiptId":"仓单ID","storageDate":"入库日期（时间戳）","totalPrice":"总价","warehouse":"仓库地址"},"returns":{"_0":"bool 是否成功"}},"freezeReceipt(string,string)":{"details":"冻结仓单","params":{"reason":"冻结原因","receiptId":"仓单ID"},"returns":{"_0":"bool 是否成功"}},"getFinance(string)":{"details":"查询融资信息","params":{"receiptId":"仓单ID"},"returns":{"active":"是否活跃","amount":"融资金额","institution":"融资机构","rate":"融资利率","status":"融资状态"}},"getFinancierReceipts(address)":{"details":"查询金融机构仓单","params":{"financier":"金融机构地址"},"returns":{"_0":"仓单ID数组"}},"getOwnerReceipts(address)":{"details":"查询用户仓单","params":{"user":"用户地址"},"returns":{"_0":"仓单ID数组"}},"getPledge(string)":{"details":"查询质押信息","params":{"receiptId":"仓单ID"},"returns":{"active":"是否活跃","amount":"质押金额","financier":"金融机构","rate":"质押利率","status":"质押状态"}},"getReceipt(string)":{"details":"查询仓单完整信息（优化版 - 使用结构体避免栈溢出）","params":{"receiptId":"仓单ID"},"returns":{"info":"仓单完整信息结构体"}},"getReceiptCount()":{"details":"查询仓单总数","returns":{"_0":"仓单总数"}},"getReceiptsOwners(string[])":{"details":"批量查询仓单货主","params":{"receiptIds":"仓单ID数组"},"returns":{"owners":"货主地址数组"}},"getReceiptsStatus(string[])":{"details":"批量查询仓单状态","params":{"receiptIds":"仓单ID数组"},"returns":{"exists":"是否存在数组","frozen":"是否冻结数组"}},"getTransferCount(string)":{"details":"查询转让历史数量","params":{"receiptId":"仓单ID"},"returns":{"_0":"转让次数"}},"getWarehouseReceipts(address)":{"details":"查询仓库仓单","params":{"warehouse":"仓库地址"},"returns":{"_0":"仓单ID数组"}},"isReceiptExists(string)":{"details":"检查仓单是否存在","params":{"receiptId":"仓单ID"},"returns":{"_0":"是否存在"}},"isReceiptFinanced(string)":{"details":"检查仓单是否在融资","params":{"receiptId":"仓单ID"},"returns":{"_0":"是否在融资"}},"isReceiptFrozen(string)":{"details":"检查仓单是否冻结","params":{"receiptId":"仓单ID"},"returns":{"_0":"是否冻结"}},"isReceiptPledged(string)":{"details":"检查仓单是否质押","params":{"receiptId":"仓单ID"},"returns":{"_0":"是否质押"}},"liquidateReceipt(string,string)":{"details":"清算仓单","params":{"reason":"清算原因","receiptId":"仓单ID"},"returns":{"_0":"bool 是否成功"}},"pledgeReceipt(string,address,uint256,uint256)":{"details":"质押仓单","params":{"amount":"质押金额","financier":"金融机构地址","rate":"质押利率（基点）","receiptId":"仓单ID"},"returns":{"_0":"bool 是否成功"}},"releaseReceipt(string,uint256)":{"details":"释放仓单","params":{"amount":"释放金额","receiptId":"仓单ID"},"returns":{"_0":"bool 是否成功"}},"setAdmin(address)":{"details":"设置管理员","params":{"newAdmin":"新管理员地址"}},"setJavaBackend(address)":{"details":"设置Java后端地址","params":{"newBackend":"新后端地址"}},"transferReceipt(string,address,uint256)":{"details":"转让仓单","params":{"amount":"转让金额","receiptId":"仓单ID","to":"受让人地址"},"returns":{"_0":"bool 是否成功"}},"unfreezeReceipt(string,string)":{"details":"解除冻结","params":{"reason":"解冻原因","receiptId":"仓单ID"},"returns":{"_0":"bool 是否成功"}},"unpledgeReceipt(string)":{"details":"解除质押","params":{"receiptId":"仓单ID"},"returns":{"_0":"bool 是否成功"}},"verifyReceipt(string)":{"details":"验证仓单","params":{"receiptId":"仓单ID"},"returns":{"_0":"bool 是否成功"}}},"title":"WarehouseReceiptV2","version":1}