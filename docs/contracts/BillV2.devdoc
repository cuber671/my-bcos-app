{"author":"FISCO BCOS Supply Chain Finance Team","details":"票据管理智能合约 V2.0 核心功能： 1. 票据生命周期管理（签发、承兑、背书、贴现、付款） 2. 质押管理（质押、解质押） 3. 融资管理（申请、批准、偿还） 4. 拆分合并（拆分、合并） 5. 担保管理（添加、移除） 6. 追索管理（发起、结算） 7. 冻结管理（冻结、解冻） 设计原则： ✅ 数据精简化与哈希化（仅9个核心字段上链） ✅ 严格访问控制（onlyAdmin, onlyJavaBackend, onlyHolder） ✅ 规避栈溢出（使用struct封装） ✅ 异常处理与状态一致性（require校验） ✅ 充分利用事件（18个事件）","kind":"dev","methods":{"acceptBill(string)":{"details":"承兑票据","params":{"billId":"票据ID"},"returns":{"_0":"bool 是否成功"}},"addGuarantee(string,address,uint256)":{"details":"添加担保","params":{"amount":"担保金额","billId":"票据ID","guarantor":"担保人"},"returns":{"_0":"bool 是否成功"}},"applyFinancing(string,address,uint256,uint256)":{"details":"申请融资","params":{"amount":"融资金额","billId":"票据ID","institution":"融资机构","rate":"融资利率（基点）"},"returns":{"_0":"bool 是否成功"}},"approveFinancing(string)":{"details":"批准融资","params":{"billId":"票据ID"},"returns":{"_0":"bool 是否成功"}},"cancelBill(string,string)":{"details":"作废票据","params":{"billId":"票据ID","reason":"作废原因"},"returns":{"_0":"bool 是否成功"}},"constructor":{"details":"构造函数，初始化合约"},"discountBill(string,address,uint256,uint256)":{"details":"贴现票据","params":{"amount":"贴现金额","billId":"票据ID","institution":"贴现机构地址","rate":"贴现利率（基点）"},"returns":{"_0":"bool 是否成功"}},"endorseBill(string,address)":{"details":"背书票据","params":{"billId":"票据ID","endorsee":"被背书人地址"},"returns":{"_0":"bool 是否成功"}},"freezeBill(string,string)":{"details":"冻结票据","params":{"billId":"票据ID","reason":"冻结原因"},"returns":{"_0":"bool 是否成功"}},"getBill(string)":{"details":"查询票据完整信息（优化版 - 使用结构体避免栈溢出）","params":{"billId":"票据ID"},"returns":{"info":"票据完整信息结构体"}},"getBillCore(string)":{"details":"查询票据核心数据","params":{"billId":"票据ID"},"returns":{"acceptor":"承兑人","amount":"票面金额","currentHolder":"当前持票人","frozen":"是否冻结","id":"票据ID","issuer":"出票人","status":"状态"}},"getBillCount()":{"details":"查询票据总数","returns":{"_0":"票据总数"}},"getBillMeta(string)":{"details":"查询票据元数据","params":{"billId":"票据ID"},"returns":{"coreDataHash":"核心数据哈希","createdAt":"创建时间","extendedDataHash":"扩展数据哈希","updatedAt":"更新时间"}},"getBillsHolders(string[])":{"details":"批量查询票据持票人","params":{"billIds":"票据ID数组"},"returns":{"currentHolders":"当前持票人数组"}},"getBillsStatus(string[])":{"details":"批量查询票据状态","params":{"billIds":"票据ID数组"},"returns":{"exists":"是否存在数组","frozen":"是否冻结数组"}},"getEndorsementCount(string)":{"details":"查询背书历史数量","params":{"billId":"票据ID"},"returns":{"_0":"背书次数"}},"getFinancing(string)":{"details":"查询融资信息","params":{"billId":"票据ID"},"returns":{"active":"是否活跃","amount":"融资金额","institution":"融资机构","rate":"融资利率","status":"融资状态"}},"getGuaranteeCount(string)":{"details":"查询担保信息数量","params":{"billId":"票据ID"},"returns":{"_0":"担保数量"}},"getHoldingBills(address)":{"details":"查询用户持有的票据","params":{"user":"用户地址"},"returns":{"_0":"票据ID数组"}},"getIssuedBills(address)":{"details":"查询用户签发的票据","params":{"user":"用户地址"},"returns":{"_0":"票据ID数组"}},"getPledge(string)":{"details":"查询质押信息","params":{"billId":"票据ID"},"returns":{"active":"是否活跃","amount":"质押金额","period":"质押期限","pledgee":"质押权人","status":"质押状态"}},"getRecourse(string)":{"details":"查询追索信息","params":{"billId":"票据ID"},"returns":{"amount":"追索金额","claimant":"追索人","reason":"追索原因","recourseDate":"追索日期","status":"追索状态"}},"initiateRecourse(string,uint256,string)":{"details":"发起追索","params":{"amount":"追索金额","billId":"票据ID","reason":"追索原因"},"returns":{"_0":"bool 是否成功"}},"isBillExists(string)":{"details":"检查票据是否存在","params":{"billId":"票据ID"},"returns":{"_0":"是否存在"}},"isBillFinancing(string)":{"details":"检查票据是否在融资","params":{"billId":"票据ID"},"returns":{"_0":"是否在融资"}},"isBillFrozen(string)":{"details":"检查票据是否冻结","params":{"billId":"票据ID"},"returns":{"_0":"是否冻结"}},"isBillPledged(string)":{"details":"检查票据是否质押","params":{"billId":"票据ID"},"returns":{"_0":"是否质押"}},"issueBill(string,address,address,uint256,uint256,uint256,bytes32,bytes32)":{"details":"签发票据（发行票据）","params":{"acceptor":"承兑人地址","amount":"票面金额","billId":"票据ID","coreDataHash":"核心数据哈希","currentHolder":"当前持票人地址","dueDate":"到期日期（时间戳）","extendedDataHash":"扩展数据哈希","issueDate":"开票日期（时间戳）"},"returns":{"_0":"bool 是否成功"}},"payBill(string)":{"details":"付款","params":{"billId":"票据ID"},"returns":{"_0":"bool 是否成功"}},"pledgeBill(string,address,uint256,uint256)":{"details":"质押票据","params":{"amount":"质押金额","billId":"票据ID","period":"质押期限（天）","pledgee":"质押权人"},"returns":{"_0":"bool 是否成功"}},"rejectFinancing(string)":{"details":"拒绝融资","params":{"billId":"票据ID"},"returns":{"_0":"bool 是否成功"}},"removeGuarantee(string,uint256)":{"details":"移除担保","params":{"billId":"票据ID","guaranteeIndex":"担保索引"},"returns":{"_0":"bool 是否成功"}},"repayFinancing(string)":{"details":"偿还融资","params":{"billId":"票据ID"},"returns":{"_0":"bool 是否成功"}},"setAdmin(address)":{"details":"设置管理员","params":{"newAdmin":"新管理员地址"}},"setJavaBackend(address)":{"details":"设置Java后端地址","params":{"newBackend":"新后端地址"}},"settleRecourse(string)":{"details":"结算追索","params":{"billId":"票据ID"},"returns":{"_0":"bool 是否成功"}},"unfreezeBill(string,string)":{"details":"解除冻结","params":{"billId":"票据ID","reason":"解冻原因"},"returns":{"_0":"bool 是否成功"}},"unpledgeBill(string)":{"details":"解除质押","params":{"billId":"票据ID"},"returns":{"_0":"bool 是否成功"}}},"title":"BillV2","version":1}